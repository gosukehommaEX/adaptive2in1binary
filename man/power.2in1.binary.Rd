% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power.2in1.binary.R
\name{power.2in1.binary}
\alias{power.2in1.binary}
\title{Power Calculation for 2-in-1 Adaptive Design with Binary Endpoints}
\usage{
power.2in1.binary(
  p1,
  p2,
  N11,
  N21,
  N12,
  N22,
  N13,
  N23,
  cutpoint,
  alpha2,
  alpha3
)
}
\arguments{
\item{p1}{True probability of responders for group 1 (treatment group).
Can be a scalar or a vector.}

\item{p2}{True probability of responders for group 2 (control group).
Must have the same length as \code{p1}.}

\item{N11}{Sample size for group 1 at stage 1 (interim analysis).}

\item{N21}{Sample size for group 2 at stage 1 (interim analysis).}

\item{N12}{Sample size for group 1 at stage 2 (Phase 2 part).
Total sample size for Phase 2 is N11 + N12.}

\item{N22}{Sample size for group 2 at stage 2 (Phase 2 part).
Total sample size for Phase 2 is N21 + N22.}

\item{N13}{Sample size for group 1 at stage 3 (Phase 3 part).
Total sample size for Phase 3 is N11 + N13.}

\item{N23}{Sample size for group 2 at stage 3 (Phase 3 part).
Total sample size for Phase 3 is N21 + N23.}

\item{cutpoint}{A cutpoint of the risk difference for the interim decision.
Can be NA (to return results for all possible cutpoints) or a single value
within -1 < cutpoint <= 1.}

\item{alpha2}{One-sided level of significance at satge 2 (e.g., 0.025).}

\item{alpha3}{One-sided level of significance at satge 3 (e.g., 0.025).}
}
\value{
A tibble with the following columns:
\itemize{
\item \code{p1}: True probability of responders for group 1
\item \code{p2}: True probability of responders for group 2
\item \code{cutpoint}: Cutpoint(s) of the risk difference
\item \code{Test}: Names of the statistical tests (Chisq, Fisher, Fisher-midP, Z-pool, Boschloo)
\item \code{Go.prob}: Go probability of expanding to a Phase 3 trial
\item \code{Power.2}: Power of tests for Phase 2 part
\item \code{Power.3}: Power of tests for Phase 3 part
\item \code{Power.Total}: Total power of tests (sum of Power.2 and Power.3)
\item \code{ESS}: Expected sample size
}
}
\description{
This function calculates the statistical power for a 2-in-1 adaptive phase 2/3
design with binary endpoints using closed-form formulas. The 2-in-1 adaptive
design allows a trial to maintain a small trial or to expand to a large trial
adaptively based on decisions made at the interim analysis. The function
simultaneously provides results for five types of one-sided statistical tests.
}
\details{
The function implements the exact power calculation methodology described in
Homma and Yoshida (20XX) for 2-in-1 adaptive designs with binary endpoints.
The design proceeds in three stages: Stage 1 (interim analysis), Stage 2
(small trial part), and Stage 3 (large trial part). At the end of Stage 1,
if the observed risk difference is greater than or equal to the cutpoint C,
the trial is expanded to Stage 3. Otherwise, it proceeds to Stage 2.

The power calculation accounts for:
\itemize{
\item Go probability: Probability of expanding to a large trial
\item Power.2: Power for the Phase 2 part (Stage 1 + Stage 2)
\item Power.3: Power for the Phase 3 part (Stage 1 + Stage 3)
\item Power.Total: Total power (sum of Power.2 and Power.3)
\item ESS: Expected sample size
}

The exact power is obtained without Monte Carlo simulations by evaluating
all possible combinations of responders at each stage.
}
\examples{
# Example 1: Single cutpoint
power.2in1.binary(
  p1 = 0.4, p2 = 0.2, N11 = 40, N21 = 20, N12 = 50, N22 = 25,
  N13 = 100, N23 = 50, cutpoint = 0.2, alpha2 = 0.025, alpha3 = 0.025
)

# Example 2: All possible cutpoints
power.2in1.binary(
  p1 = 0.4, p2 = 0.2, N11 = 40, N21 = 20, N12 = 50, N22 = 25,
  N13 = 100, N23 = 50, cutpoint = NA, alpha2 = 0.025, alpha3 = 0.025
)

# Example 3: Multiple (p1, p2) combinations
p1_vec <- c(0.4, 0.5, 0.6)
p2_vec <- c(0.2, 0.2, 0.2)
power.2in1.binary(
  p1 = p1_vec, p2 = p2_vec, N11 = 30, N21 = 30, N12 = 40, N22 = 40,
  N13 = 80, N23 = 80, cutpoint = 0.2, alpha2 = 0.025, alpha3 = 0.025
)
}
\references{
Homma, G. and Yoshida, T. (20XX). A 2-in-1 adaptive design for binary endpoints.
}
